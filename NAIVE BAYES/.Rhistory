prop.table(table(lyrics_dtm_test_labels))
#find frequently used words
lyrics_freq_words <- findFreqTerms(lyrics_dtm_train, 20)
lyrics_dtm_freq_train <- lyrics_dtm_train[ , lyrics_freq_words]
lyrics_dtm_freq_test <- lyrics_dtm_test[ , lyrics_freq_words]
#convert counts to categorical data
convert_counts <- function(x) {
x <- ifelse(x > 0, "Yes", "No")
}
lyrics_dtm_train <- apply(lyrics_dtm_freq_train, MARGIN = 2, convert_counts)
lyrics_dtm_test  <- apply(lyrics_dtm_freq_test, MARGIN = 2, convert_counts)
#create model and predict
lyrics_classifier <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels)
lyrics_test_pred <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
library (tm)
library(SnowballC)
library(dplyr)
library(e1071)
library(gmodels)
lyrics_raw <- read.csv("lyrics.csv", stringsAsFactors=FALSE)
artist_name <- "drake"
train_size <- 75000
num_of_songs <- 100000
lyrics_raw$artist <- ifelse(lyrics_raw$artist == artist_name, artist_name, "other_artist")
#lyrics_raw$artist <- ifelse(lyrics_raw$artist == "eminem", "eminem", "other_artist")
lyrics_raw$artist <- factor(lyrics_raw$artist)
summary(lyrics_raw)
head (lyrics_raw)
prop.table(table(lyrics_raw$artist))
artist_songs <- subset (lyrics_raw, artist==artist_name) #drake")
summary (artist_songs)
other_artist_songs <- subset(lyrics_raw, artist=="other_artist")
summary (other_artist_songs)
lyrics_raw <- rbind(artist_songs,sample_n(other_artist_songs,num_of_songs-nrow(artist_songs))) #9614))
#randomize order
set.seed(42)
rows <- sample(nrow(lyrics_raw))
lyrics_raw <- lyrics_raw[rows, ]
prop.table(table(lyrics_raw$artist))
lyrics_corpus <- VCorpus(VectorSource(lyrics_raw$lyrics))
#clean corpus
lyrics_corpus_clean <- tm_map(lyrics_corpus,
content_transformer(tolower))
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removeNumbers)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean,
removeWords, stopwords())
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removePunctuation)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stemDocument)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stripWhitespace)
lyrics_dtm <- DocumentTermMatrix(lyrics_corpus_clean) #create dtm
#seperate training data from testing data
lyrics_dtm_train <- lyrics_dtm[1:train_size, ]
lyrics_dtm_test <- lyrics_dtm[(train_size+1):num_of_songs, ]
lyrics_dtm_train_labels <- lyrics_raw[1:train_size, ]$artist
lyrics_dtm_test_labels <- lyrics_raw[(train_size+1):num_of_songs, ]$artist
#check proportions of drake to other artists in the partitions
prop.table(table(lyrics_dtm_train_labels))
prop.table(table(lyrics_dtm_test_labels))
#find frequently used words
lyrics_freq_words <- findFreqTerms(lyrics_dtm_train, 20)
lyrics_dtm_freq_train <- lyrics_dtm_train[ , lyrics_freq_words]
lyrics_dtm_freq_test <- lyrics_dtm_test[ , lyrics_freq_words]
#convert counts to categorical data
convert_counts <- function(x) {
x <- ifelse(x > 0, "Yes", "No")
}
lyrics_dtm_train <- apply(lyrics_dtm_freq_train, MARGIN = 2, convert_counts)
#find frequently used words
lyrics_freq_words <- findFreqTerms(lyrics_dtm_train, 20)
lyrics_dtm_freq_train <- lyrics_dtm_train[ , lyrics_freq_words]
lyrics_dtm_freq_test <- lyrics_dtm_test[ , lyrics_freq_words]
#convert counts to categorical data
convert_counts <- function(x) {
x <- ifelse(x > 0, "Yes", "No")
}
lyrics_dtm_train <- apply(lyrics_dtm_freq_train, MARGIN = 2, convert_counts)
library (tm)
library(SnowballC)
library(dplyr)
library(e1071)
library(gmodels)
lyrics_raw <- read.csv("lyrics.csv", stringsAsFactors=FALSE)
artist_name <- "drake"
train_size <- 15000
num_of_songs <- 20000
lyrics_raw$artist <- ifelse(lyrics_raw$artist == artist_name, artist_name, "other_artist")
#lyrics_raw$artist <- ifelse(lyrics_raw$artist == "eminem", "eminem", "other_artist")
lyrics_raw$artist <- factor(lyrics_raw$artist)
summary(lyrics_raw)
head (lyrics_raw)
prop.table(table(lyrics_raw$artist))
artist_songs <- subset (lyrics_raw, artist==artist_name) #drake")
summary (artist_songs)
other_artist_songs <- subset(lyrics_raw, artist=="other_artist")
summary (other_artist_songs)
lyrics_raw <- rbind(artist_songs,sample_n(other_artist_songs,num_of_songs-nrow(artist_songs))) #9614))
#randomize order
set.seed(42)
rows <- sample(nrow(lyrics_raw))
lyrics_raw <- lyrics_raw[rows, ]
prop.table(table(lyrics_raw$artist))
lyrics_corpus <- VCorpus(VectorSource(lyrics_raw$lyrics))
#clean corpus
lyrics_corpus_clean <- tm_map(lyrics_corpus,
content_transformer(tolower))
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removeNumbers)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean,
removeWords, stopwords())
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removePunctuation)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stemDocument)
library (tm)
library(SnowballC)
library(dplyr)
library(e1071)
library(gmodels)
lyrics_raw <- read.csv("lyrics.csv", stringsAsFactors=FALSE)
artist_name <- "drake"
train_size <- 15000
num_of_songs <- 20000
lyrics_raw$artist <- ifelse(lyrics_raw$artist == artist_name, artist_name, "other_artist")
#lyrics_raw$artist <- ifelse(lyrics_raw$artist == "eminem", "eminem", "other_artist")
lyrics_raw$artist <- factor(lyrics_raw$artist)
summary(lyrics_raw)
head (lyrics_raw)
prop.table(table(lyrics_raw$artist))
artist_songs <- subset (lyrics_raw, artist==artist_name) #drake")
summary (artist_songs)
other_artist_songs <- subset(lyrics_raw, artist=="other_artist")
summary (other_artist_songs)
lyrics_raw <- rbind(artist_songs,sample_n(other_artist_songs,num_of_songs-nrow(artist_songs))) #9614))
#randomize order
set.seed(42)
rows <- sample(nrow(lyrics_raw))
lyrics_raw <- lyrics_raw[rows, ]
prop.table(table(lyrics_raw$artist))
lyrics_corpus <- VCorpus(VectorSource(lyrics_raw$lyrics))
#clean corpus
lyrics_corpus_clean <- tm_map(lyrics_corpus,
content_transformer(tolower))
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removeNumbers)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean,
removeWords, stopwords())
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removePunctuation)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stemDocument)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stripWhitespace)
lyrics_dtm <- DocumentTermMatrix(lyrics_corpus_clean) #create dtm
#seperate training data from testing data
lyrics_dtm_train <- lyrics_dtm[1:train_size, ]
lyrics_dtm_test <- lyrics_dtm[(train_size+1):num_of_songs, ]
lyrics_dtm_train_labels <- lyrics_raw[1:train_size, ]$artist
lyrics_dtm_test_labels <- lyrics_raw[(train_size+1):num_of_songs, ]$artist
#check proportions of drake to other artists in the partitions
prop.table(table(lyrics_dtm_train_labels))
prop.table(table(lyrics_dtm_test_labels))
#find frequently used words
lyrics_freq_words <- findFreqTerms(lyrics_dtm_train, 20)
lyrics_dtm_freq_train <- lyrics_dtm_train[ , lyrics_freq_words]
lyrics_dtm_freq_test <- lyrics_dtm_test[ , lyrics_freq_words]
#convert counts to categorical data
convert_counts <- function(x) {
x <- ifelse(x > 0, "Yes", "No")
}
lyrics_dtm_train <- apply(lyrics_dtm_freq_train, MARGIN = 2, convert_counts)
lyrics_dtm_test  <- apply(lyrics_dtm_freq_test, MARGIN = 2, convert_counts)
#create model and predict
lyrics_classifier <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels)
lyrics_test_pred <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
#try with a laplace modifier
lyrics_classifier2 <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels, laplace=1)
lyrics_test_pred2 <- predict(lyrics_classifier, lyrics_dtm_test)
library (tm)
library(SnowballC)
library(dplyr)
library(e1071)
library(gmodels)
lyrics_raw <- read.csv("lyrics.csv", stringsAsFactors=FALSE)
artist_name <- "beyonce-knowles"
train_size <- 1000
num_of_songs <- 1500
lyrics_raw$artist <- ifelse(lyrics_raw$artist == artist_name, artist_name, "other_artist")
#lyrics_raw$artist <- ifelse(lyrics_raw$artist == "eminem", "eminem", "other_artist")
lyrics_raw$artist <- factor(lyrics_raw$artist)
summary(lyrics_raw)
head (lyrics_raw)
prop.table(table(lyrics_raw$artist))
artist_songs <- subset (lyrics_raw, artist==artist_name)
summary (artist_songs)
other_artist_songs <- subset(lyrics_raw, artist=="other_artist")
summary (other_artist_songs)
lyrics_raw <- rbind(artist_songs,sample_n(other_artist_songs,num_of_songs-nrow(artist_songs))) #9614))
#randomize order
set.seed(42)
rows <- sample(nrow(lyrics_raw))
lyrics_raw <- lyrics_raw[rows, ]
prop.table(table(lyrics_raw$artist))
lyrics_corpus <- VCorpus(VectorSource(lyrics_raw$lyrics))
#clean corpus
lyrics_corpus_clean <- tm_map(lyrics_corpus,
content_transformer(tolower))
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removeNumbers)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean,
removeWords, stopwords())
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removePunctuation)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stemDocument)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stripWhitespace)
lyrics_dtm <- DocumentTermMatrix(lyrics_corpus_clean) #create dtm
#seperate training data from testing data
lyrics_dtm_train <- lyrics_dtm[1:train_size, ]
lyrics_dtm_test <- lyrics_dtm[(train_size+1):num_of_songs, ]
lyrics_dtm_train_labels <- lyrics_raw[1:train_size, ]$artist
lyrics_dtm_test_labels <- lyrics_raw[(train_size+1):num_of_songs, ]$artist
#check proportions of drake to other artists in the partitions
prop.table(table(lyrics_dtm_train_labels))
prop.table(table(lyrics_dtm_test_labels))
#find frequently used words
lyrics_freq_words <- findFreqTerms(lyrics_dtm_train, 20)
lyrics_dtm_freq_train <- lyrics_dtm_train[ , lyrics_freq_words]
lyrics_dtm_freq_test <- lyrics_dtm_test[ , lyrics_freq_words]
#convert counts to categorical data
convert_counts <- function(x) {
x <- ifelse(x > 0, "Yes", "No")
}
lyrics_dtm_train <- apply(lyrics_dtm_freq_train, MARGIN = 2, convert_counts)
lyrics_dtm_test  <- apply(lyrics_dtm_freq_test, MARGIN = 2, convert_counts)
#create model and predict
lyrics_classifier <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels)
lyrics_test_pred <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
#try with a laplace modifier
lyrics_classifier2 <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels, laplace=1)
lyrics_test_pred2 <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred2, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
library (tm)
library(SnowballC)
library(dplyr)
library(e1071)
library(gmodels)
lyrics_raw <- read.csv("lyrics.csv", stringsAsFactors=FALSE)
artist_name <- "george-duke"
train_size <- 1000
num_of_songs <- 1500
lyrics_raw$artist <- ifelse(lyrics_raw$artist == artist_name, artist_name, "other_artist")
#lyrics_raw$artist <- ifelse(lyrics_raw$artist == "eminem", "eminem", "other_artist")
lyrics_raw$artist <- factor(lyrics_raw$artist)
summary(lyrics_raw)
head (lyrics_raw)
prop.table(table(lyrics_raw$artist))
artist_songs <- subset (lyrics_raw, artist==artist_name)
summary (artist_songs)
other_artist_songs <- subset(lyrics_raw, artist=="other_artist")
summary (other_artist_songs)
lyrics_raw <- rbind(artist_songs,sample_n(other_artist_songs,num_of_songs-nrow(artist_songs))) #9614))
#randomize order
set.seed(42)
rows <- sample(nrow(lyrics_raw))
lyrics_raw <- lyrics_raw[rows, ]
prop.table(table(lyrics_raw$artist))
lyrics_corpus <- VCorpus(VectorSource(lyrics_raw$lyrics))
#clean corpus
lyrics_corpus_clean <- tm_map(lyrics_corpus,
content_transformer(tolower))
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removeNumbers)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean,
removeWords, stopwords())
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removePunctuation)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stemDocument)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stripWhitespace)
lyrics_dtm <- DocumentTermMatrix(lyrics_corpus_clean) #create dtm
#seperate training data from testing data
lyrics_dtm_train <- lyrics_dtm[1:train_size, ]
lyrics_dtm_test <- lyrics_dtm[(train_size+1):num_of_songs, ]
lyrics_dtm_train_labels <- lyrics_raw[1:train_size, ]$artist
lyrics_dtm_test_labels <- lyrics_raw[(train_size+1):num_of_songs, ]$artist
#check proportions of drake to other artists in the partitions
prop.table(table(lyrics_dtm_train_labels))
prop.table(table(lyrics_dtm_test_labels))
#find frequently used words
lyrics_freq_words <- findFreqTerms(lyrics_dtm_train, 20)
lyrics_dtm_freq_train <- lyrics_dtm_train[ , lyrics_freq_words]
lyrics_dtm_freq_test <- lyrics_dtm_test[ , lyrics_freq_words]
#convert counts to categorical data
convert_counts <- function(x) {
x <- ifelse(x > 0, "Yes", "No")
}
lyrics_dtm_train <- apply(lyrics_dtm_freq_train, MARGIN = 2, convert_counts)
lyrics_dtm_test  <- apply(lyrics_dtm_freq_test, MARGIN = 2, convert_counts)
#create model and predict
lyrics_classifier <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels)
lyrics_test_pred <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
#try with a laplace modifier
lyrics_classifier2 <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels, laplace=1)
lyrics_test_pred2 <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred2, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
library (tm)
library(SnowballC)
library(dplyr)
library(e1071)
library(gmodels)
lyrics_raw <- read.csv("lyrics.csv", stringsAsFactors=FALSE)
artist_name <- "fantasia"
train_size <- 1000
num_of_songs <- 1500
lyrics_raw$artist <- ifelse(lyrics_raw$artist == artist_name, artist_name, "other_artist")
#lyrics_raw$artist <- ifelse(lyrics_raw$artist == "eminem", "eminem", "other_artist")
lyrics_raw$artist <- factor(lyrics_raw$artist)
summary(lyrics_raw)
head (lyrics_raw)
prop.table(table(lyrics_raw$artist))
artist_songs <- subset (lyrics_raw, artist==artist_name)
summary (artist_songs)
other_artist_songs <- subset(lyrics_raw, artist=="other_artist")
summary (other_artist_songs)
lyrics_raw <- rbind(artist_songs,sample_n(other_artist_songs,num_of_songs-nrow(artist_songs))) #9614))
#randomize order
set.seed(42)
rows <- sample(nrow(lyrics_raw))
lyrics_raw <- lyrics_raw[rows, ]
prop.table(table(lyrics_raw$artist))
lyrics_corpus <- VCorpus(VectorSource(lyrics_raw$lyrics))
#clean corpus
lyrics_corpus_clean <- tm_map(lyrics_corpus,
content_transformer(tolower))
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removeNumbers)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean,
removeWords, stopwords())
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removePunctuation)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stemDocument)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stripWhitespace)
lyrics_dtm <- DocumentTermMatrix(lyrics_corpus_clean) #create dtm
#seperate training data from testing data
lyrics_dtm_train <- lyrics_dtm[1:train_size, ]
lyrics_dtm_test <- lyrics_dtm[(train_size+1):num_of_songs, ]
lyrics_dtm_train_labels <- lyrics_raw[1:train_size, ]$artist
lyrics_dtm_test_labels <- lyrics_raw[(train_size+1):num_of_songs, ]$artist
#check proportions of drake to other artists in the partitions
prop.table(table(lyrics_dtm_train_labels))
prop.table(table(lyrics_dtm_test_labels))
#find frequently used words
lyrics_freq_words <- findFreqTerms(lyrics_dtm_train, 20)
lyrics_dtm_freq_train <- lyrics_dtm_train[ , lyrics_freq_words]
lyrics_dtm_freq_test <- lyrics_dtm_test[ , lyrics_freq_words]
#convert counts to categorical data
convert_counts <- function(x) {
x <- ifelse(x > 0, "Yes", "No")
}
lyrics_dtm_train <- apply(lyrics_dtm_freq_train, MARGIN = 2, convert_counts)
lyrics_dtm_test  <- apply(lyrics_dtm_freq_test, MARGIN = 2, convert_counts)
#create model and predict
lyrics_classifier <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels)
lyrics_test_pred <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
#try with a laplace modifier
lyrics_classifier2 <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels, laplace=1)
lyrics_test_pred2 <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred2, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
#try with a laplace modifier
lyrics_classifier2 <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels, laplace=100)
lyrics_test_pred2 <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred2, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
library (tm)
library(SnowballC)
library(dplyr)
library(e1071)
library(gmodels)
lyrics_raw <- read.csv("lyrics.csv", stringsAsFactors=FALSE)
artist_name <- "drake"
train_size <- 1000
num_of_songs <- 1500
lyrics_raw$artist <- ifelse(lyrics_raw$artist == artist_name, artist_name, "other_artist")
#lyrics_raw$artist <- ifelse(lyrics_raw$artist == "eminem", "eminem", "other_artist")
lyrics_raw$artist <- factor(lyrics_raw$artist)
summary(lyrics_raw)
head (lyrics_raw)
prop.table(table(lyrics_raw$artist))
artist_songs <- subset (lyrics_raw, artist==artist_name)
summary (artist_songs)
other_artist_songs <- subset(lyrics_raw, artist=="other_artist")
summary (other_artist_songs)
lyrics_raw <- rbind(artist_songs,sample_n(other_artist_songs,num_of_songs-nrow(artist_songs))) #9614))
#randomize order
set.seed(42)
rows <- sample(nrow(lyrics_raw))
lyrics_raw <- lyrics_raw[rows, ]
prop.table(table(lyrics_raw$artist))
lyrics_corpus <- VCorpus(VectorSource(lyrics_raw$lyrics))
#clean corpus
lyrics_corpus_clean <- tm_map(lyrics_corpus,
content_transformer(tolower))
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removeNumbers)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean,
removeWords, stopwords())
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removePunctuation)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stemDocument)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stripWhitespace)
lyrics_dtm <- DocumentTermMatrix(lyrics_corpus_clean) #create dtm
#seperate training data from testing data
lyrics_dtm_train <- lyrics_dtm[1:train_size, ]
lyrics_dtm_test <- lyrics_dtm[(train_size+1):num_of_songs, ]
lyrics_dtm_train_labels <- lyrics_raw[1:train_size, ]$artist
lyrics_dtm_test_labels <- lyrics_raw[(train_size+1):num_of_songs, ]$artist
#check proportions of drake to other artists in the partitions
prop.table(table(lyrics_dtm_train_labels))
prop.table(table(lyrics_dtm_test_labels))
#find frequently used words
lyrics_freq_words <- findFreqTerms(lyrics_dtm_train, 20)
lyrics_dtm_freq_train <- lyrics_dtm_train[ , lyrics_freq_words]
lyrics_dtm_freq_test <- lyrics_dtm_test[ , lyrics_freq_words]
#convert counts to categorical data
convert_counts <- function(x) {
x <- ifelse(x > 0, "Yes", "No")
}
lyrics_dtm_train <- apply(lyrics_dtm_freq_train, MARGIN = 2, convert_counts)
lyrics_dtm_test  <- apply(lyrics_dtm_freq_test, MARGIN = 2, convert_counts)
#create model and predict
lyrics_classifier <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels)
lyrics_test_pred <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
#try with a laplace modifier
lyrics_classifier2 <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels, laplace=100)
lyrics_test_pred2 <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred2, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
library (tm)
library(SnowballC)
library(dplyr)
library(e1071)
library(gmodels)
lyrics_raw <- read.csv("lyrics.csv", stringsAsFactors=FALSE)
artist_name <- "drake"
train_size <- 7500
num_of_songs <- 10000
lyrics_raw$artist <- ifelse(lyrics_raw$artist == artist_name, artist_name, "other_artist")
#lyrics_raw$artist <- ifelse(lyrics_raw$artist == "eminem", "eminem", "other_artist")
lyrics_raw$artist <- factor(lyrics_raw$artist)
summary(lyrics_raw)
head (lyrics_raw)
prop.table(table(lyrics_raw$artist))
artist_songs <- subset (lyrics_raw, artist==artist_name)
summary (artist_songs)
other_artist_songs <- subset(lyrics_raw, artist=="other_artist")
summary (other_artist_songs)
lyrics_raw <- rbind(artist_songs,sample_n(other_artist_songs,num_of_songs-nrow(artist_songs))) #9614))
#randomize order
set.seed(42)
rows <- sample(nrow(lyrics_raw))
lyrics_raw <- lyrics_raw[rows, ]
prop.table(table(lyrics_raw$artist))
lyrics_corpus <- VCorpus(VectorSource(lyrics_raw$lyrics))
#clean corpus
lyrics_corpus_clean <- tm_map(lyrics_corpus,
content_transformer(tolower))
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removeNumbers)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean,
removeWords, stopwords())
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, removePunctuation)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stemDocument)
lyrics_corpus_clean <- tm_map(lyrics_corpus_clean, stripWhitespace)
lyrics_dtm <- DocumentTermMatrix(lyrics_corpus_clean) #create dtm
#seperate training data from testing data
lyrics_dtm_train <- lyrics_dtm[1:train_size, ]
lyrics_dtm_test <- lyrics_dtm[(train_size+1):num_of_songs, ]
lyrics_dtm_train_labels <- lyrics_raw[1:train_size, ]$artist
lyrics_dtm_test_labels <- lyrics_raw[(train_size+1):num_of_songs, ]$artist
#check proportions of drake to other artists in the partitions
prop.table(table(lyrics_dtm_train_labels))
prop.table(table(lyrics_dtm_test_labels))
#find frequently used words
lyrics_freq_words <- findFreqTerms(lyrics_dtm_train, 20)
lyrics_dtm_freq_train <- lyrics_dtm_train[ , lyrics_freq_words]
lyrics_dtm_freq_test <- lyrics_dtm_test[ , lyrics_freq_words]
#convert counts to categorical data
convert_counts <- function(x) {
x <- ifelse(x > 0, "Yes", "No")
}
lyrics_dtm_train <- apply(lyrics_dtm_freq_train, MARGIN = 2, convert_counts)
lyrics_dtm_test  <- apply(lyrics_dtm_freq_test, MARGIN = 2, convert_counts)
#create model and predict
lyrics_classifier <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels)
lyrics_test_pred <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
#try with a laplace modifier
lyrics_classifier2 <- naiveBayes(lyrics_dtm_train, lyrics_dtm_train_labels, laplace=100)
lyrics_test_pred2 <- predict(lyrics_classifier, lyrics_dtm_test)
CrossTable(lyrics_test_pred2, lyrics_dtm_test_labels,
prop.chisq = FALSE, prop.c = FALSE, prop.r = FALSE,
dnn = c('predicted', 'actual'))
